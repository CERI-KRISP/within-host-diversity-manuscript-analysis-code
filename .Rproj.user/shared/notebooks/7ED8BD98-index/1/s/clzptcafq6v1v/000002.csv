"0","# variantsLong <- genomicStats_purged %>% "
"0","#                     select(""iSNVs"", ""SNVs"") %>% "
"0","#                     pivot_longer(c(""iSNVs"", ""SNVs""), names_to = ""Polymorphisms"", values_to = ""Counts"")"
"0","# "
"0","# ggplot(variantsLong,  aes(x=""Polymorphisms"", y=""Counts"", fill=""Polymorphisms"")) +"
"0","#     geom_violin() +"
"0","#     geom_boxplot( color=""grey"", alpha=0.2) +"
"0","#     scale_fill_viridis(discrete = TRUE) +"
"0","#     theme_ipsum() +"
"0","#     theme("
"0","#       legend.position=""none"","
"0","#       plot.title = element_text(size=11)"
"0","#     ) +"
"0","#     ggtitle(""A Violin wrapping a boxplot"") +"
"0","#     xlab("""")"
"0","## in how many samples does a mutation occur"
"0","variant_freqs_by_sample <- df_snvs_isnvs_purged %>% "
"0","                                select(Sample, Polymorphism, Mutation, outbreak) %>% "
"0","                                group_by(Polymorphism, Mutation, outbreak) %>% "
"0","                                  summarise(n_Sample = n())"
"0","variant_freqs_by_sample$POS  <-  as.numeric(numextract(variant_freqs_by_sample$Mutation))"
"0","variant_freqs_by_sample <- variant_freqs_by_sample %>% mutate("
"0","     samplePerc = round((n_Sample/109) * 100, 0)"
"0",")"
"0","variant_freqs_by_sample$Polymorphism <- "
"0","  factor(variant_freqs_by_sample$Polymorphism, levels = c(""iSNV"", ""SNV""), labels = c(""3% <= Freq <= 50%"", ""Freq. >= 50%""))"
"0","#variant_freqs_by_sample$p <- ifelse(count(variant_freqs_by_sample$Mutation) > 1, 1, 0)"
"0","#totals <- as.vector(by(variant_freqs_by_sample$samplePerc, variant_freqs_by_sample$Mutation, sum))"
"0","#pos <- rep(totals + 1, each=3)"
"0","plt_allele_distn <- ggplot(variant_freqs_by_sample, aes(x = POS/1000, y = samplePerc)) +"
"0","                          geom_bar(stat=""identity"", width=0.07, aes(fill = Polymorphism)) +"
"0","                          xlab(""Nucleotide Position (kb)"")+"
"0","                          ylab(""Samples Sharing Mutation Position (%)"")+"
"0","                          scale_y_continuous(limits = c(0,100),breaks = seq(0, 100, by = 20))+"
"0","                          scale_x_continuous(limits = c(0,30),breaks = seq(0, 30, by = 5))+"
"0","                          geom_hline(yintercept=50, color = ""gray75"", alpha=0.5)+"
"0","                          geom_hline(yintercept=10, color = ""gray75"", alpha=0.5)+"
"0","                          scale_fill_manual(values = c(""#D4AF37"", ""#4169E1"")) +"
"0","                          facet_grid(rows = vars(outbreak))+"
"0","                          #geom_text(aes(label=ifelse((samplePerc >= 10 ), Mutation, """")), vjust=-0.3, size=3.5)+"
"0","                          theme_minimal() +"
"0","                          theme(panel.grid.major = element_blank(),"
"0","                                panel.grid.minor = element_blank(),"
"0","                                axis.title.x = element_text(size=15),"
"0","                                axis.title.y = element_text(size=15),"
"0","                                axis.text=element_text(size=10),"
"0","                                axis.line.x = element_line(colour = ""black"", size = 0.5),"
"0","                                legend.position = ""top"")"
"0","plt_allele_distn"
