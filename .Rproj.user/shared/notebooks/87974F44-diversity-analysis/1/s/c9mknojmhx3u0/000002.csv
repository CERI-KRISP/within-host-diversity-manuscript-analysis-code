"0","##Extract only participating samples"
"0","all_mapped_ch1_outbreak_ids <- unique(c(df_transmission_pairs_ch1$donor_id, df_transmission_pairs_ch1$recipient_id))"
"0","df_dates_pairs_confirmed_ch1 <- samples_metadata_purged  %>% "
"0","                    filter(seqIds %in% all_mapped_ch1_outbreak_ids) %>% "
"0","                    select(seqIds, date)"
"0","df_days_between_confirm_ch1 <- df_transmission_pairs_ch1"
"0","df_days_between_confirm_ch1 <-  left_join(df_days_between_confirm_ch1, df_dates_pairs_confirmed_ch1, by = c(""donor_id"" = ""seqIds"")) "
"0","colnames(df_days_between_confirm_ch1)[5] <- ""donor_date"""
"0","df_days_between_confirm_ch1 <-  left_join(df_days_between_confirm_ch1, df_dates_pairs_confirmed_ch1, by = c(""recipient_id"" = ""seqIds""))"
"0","colnames(df_days_between_confirm_ch1)[6] <- ""recipient_date"""
"0","df_days_between_confirm_ch1 <- df_days_between_confirm_ch1 %>% mutate(days_ = as.Date(as.character(df_days_between_confirm_ch1$recipient_date), format=""%Y-%m-%d"")-"
"0","                  as.Date(as.character(df_days_between_confirm_ch1$donor_date), format=""%Y-%m-%d""),"
"0","                  pairId = paste0(donor_oid, ""_"", recipient_oid))"
"0","### Add days difference to df_staug_minor_allele_distn"
"0","df_staug_minor_allele_distn_ <- inner_join(df_staug_minor_allele_distn, df_days_between_confirm_ch1[, c(""days_"",""pairId"")], by = c(""from_to"" = ""pairId""))"
"0","###"
"0","ggscatter(df_staug_minor_allele_distn_, x = ""days_"", y = ""don_rec_shared_count"","
"0","                 add = ""reg.line"",  # Add regressin line"
"0","                 add.params = list(color = ""blue"", fill = ""lightgray""), # Customize reg. line"
"0","                 conf.int = TRUE # Add confidence interval"
"0","  )+ xlab(""Distance"") +"
"0","  ylab(""Residual"") + "
"0","  #facet_grid(cols = vars(Sample)) +"
"0","  stat_cor(method = ""pearson"") + "
"0","  theme_bw()+"
"0","  theme(axis.title.x = element_text(size=15),"
"0","        axis.title.y = element_text(size=15),"
"0","        axis.text=element_text(size=12),"
"0","        legend.title = element_text(size = 15),"
"0","        legend.text = element_text(size = 12))"
