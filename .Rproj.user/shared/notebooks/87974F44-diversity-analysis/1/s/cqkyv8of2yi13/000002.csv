"0","possible_pairs.dist_ch1 <- plyr::adply(as_tibble(df_transmission_pairs_ch1), 1, summarize, L1_norm = dist_tp(c(donor_id, recipient_id), snv = df_snvs_isnvs_purged)) # Get the genetic distance between pairs! Takes the longest."
"0","## Create pair ids"
"0","possible_pairs.dist_ch1$pairId <- paste0(possible_pairs.dist_ch1$donor_oid, ""_"", possible_pairs.dist_ch1$recipient_oid)"
"0","# Now preprocess and add the snpdistances column to the distance df (create on the index page of readme)"
"0","CH1_purged_snpdists$genome1_shortId <- sapply(str_split(gsub(""KZN-ETH/CH1-"", """", paste0(CH1_purged_snpdists$genome1)), "
"0","                                               ""/"", n = 3, simplify = FALSE), `[`, 2)"
"0","CH1_purged_snpdists$genome2_shortId <- sapply(str_split(gsub(""KZN-ETH/CH1-"", """", paste0(CH1_purged_snpdists$genome2)), "
"0","                                               ""/"", n = 3, simplify = FALSE), `[`, 2)"
"0","CH1_purged_snpdists$pairId <- paste0(CH1_purged_snpdists$genome1_shortId,""_"",CH1_purged_snpdists$genome2_shortId)"
"0","df_staug_minor_allele_distn__ <- inner_join(df_staug_minor_allele_distn_, CH1_purged_snpdists[, c(""pairId"",""snpdist"")], by = c(""from_to"" = ""pairId""))"
"0","df_staug_minor_allele_distn__ <- inner_join(df_staug_minor_allele_distn__, possible_pairs.dist_ch1[, c(""pairId"",""L1_norm"")], by = c(""from_to"" = ""pairId""))"
