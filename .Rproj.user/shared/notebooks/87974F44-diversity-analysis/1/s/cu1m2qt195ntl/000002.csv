"0","#### Shared mutation plots:"
"0","## K0055,K0040"
"0","for(row in 1:nrow(df_transmission_pairs_ch1)) {"
"0","  "
"0","   donor_id <- as.character(df_transmission_pairs_ch1[row, ""donor_id""])"
"0","   donor_oid <- as.character(df_transmission_pairs_ch1[row, ""donor_oid""])"
"0","   recipient_id <- as.character(df_transmission_pairs_ch1[row, ""recipient_id""])"
"0","   recipient_oid <- as.character(df_transmission_pairs_ch1[row, ""recipient_oid""])"
"0","   "
"0","   donor_df <- df_isnvs_ch1[df_isnvs_ch1$Sample == donor_id, ]"
"0","   recipient_df <- df_snvs_isnvs_purged[df_snvs_isnvs_purged$Sample == recipient_id, ]"
"0","   "
"0","   if(dim(donor_df)[1] != 0 | dim(recipient_df)[1] != 0) {"
"0","     donor_df$role <- ""source"" "
"0","     recipient_df$role <- ""recipient"""
"0","     df_don_rec <- rbind(donor_df, recipient_df) "
"0","     df_don_rec$role <- factor(df_don_rec$role, levels = c(""source"", ""recipient""), labels = c(donor_oid, recipient_oid))"
"0","     }"
"0","     "
"0","     df_don_rec_shared <- df_don_rec[df_don_rec$Mutation %in% c(intersect(donor_df$Mutation, recipient_df$Mutation)), ]"
"0","     if(dim(df_don_rec_shared)[1] != 0){"
"0","        df_don_rec_shared$AF <- as.numeric(df_don_rec_shared$AF)"
"0","    "
"0","        sPlot <- ggplot(dplyr::arrange(df_don_rec_shared, -AF), aes(x =  Mutation, y = AF, fill = role)) +"
"0","        geom_bar(stat=""identity"", position=position_dodge()) +"
"0","        scale_fill_manual("""", values = c(""#cc3333"",""#3399cc"")) +"
"0","        theme_minimal() +"
"0","        xlab(""Shared Variant"") +"
"0","        ylab(""Intrahost Variant Freq."") +"
"0","        theme(axis.text.x = element_text(face=""plain"", color=""#000000"", size=12, angle=45, margin = margin(7,0,0,0), hjust = .7),"
"0","              axis.text.y = element_text(face=""plain"", color=""#000000"", size=12),"
"0","              panel.grid.major.x = element_blank(),"
"0","              panel.grid.minor = element_blank(),"
"0","              axis.title.x = element_text(size=15),"
"0","              axis.title.y = element_text(size=15),"
"0","              axis.text=element_text(size=11),"
"0","              legend.title=element_text(size=14),"
"0","              legend.position = ""top"","
"0","              legend.text=element_text(size=12))"
"0","      print(sPlot)"
"0","  }"
"0","}"
