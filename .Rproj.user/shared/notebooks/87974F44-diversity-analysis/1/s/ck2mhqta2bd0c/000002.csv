"0","## get outbreak ids"
"0","df_ch3_ids <- df_snvs_isnvs_purged %>% filter(outbreak == ""CH3"") %>% select(Sample, outbreak_id) %>% unique()"
"0","ch3_ids <- df_ch3_ids$Sample #Get vector of CH3 unique ids - 74"
"0","## get all possible pairs"
"0","library(gtools)"
"0","df_all_ch3_pairs_ <- data.frame(permutations(n=length(ch3_ids),r=2,v=ch3_ids), stringsAsFactors = F)"
"0","names(df_all_ch3_pairs_) <- c(""donor_id"", ""recipient_id"")"
"0","#all_mapped_ch1_outbreak_ids <- unique(df_all_ch3_pairs$donor)"
"0","df_dates_ch3 <- samples_metadata_purged  %>% "
"0","                    filter(outbreak == ""CH3"") %>% "
"0","                    select(seqIds, outbreak_id, date)"
"0","df_days_between_ch3_pairs <- df_all_ch3_pairs_"
"0","df_days_between_ch3_pairs <-  left_join(df_days_between_ch3_pairs, df_dates_ch3, by = c(""donor_id"" = ""seqIds"")) "
"0","colnames(df_days_between_ch3_pairs)[c(3:4)] <- c(""donor_oid"", ""donor_date"")"
"0","df_days_between_ch3_pairs <-  left_join(df_days_between_ch3_pairs, df_dates_ch3, by = c(""recipient_id"" = ""seqIds""))"
"0","colnames(df_days_between_ch3_pairs)[c(5:6)] <- c(""recipient_oid"", ""recipient_date"" )"
"0","df_all_ch3_pairs <- df_days_between_ch3_pairs %>% mutate(days_between_samples = as.Date(as.character(df_days_between_ch3_pairs$recipient_date), format=""%Y-%m-%d"")-"
"0","                  as.Date(as.character(df_days_between_ch3_pairs$donor_date), format=""%Y-%m-%d""),"
"0","                  pairId = paste0(donor_id, ""_"", recipient_id),"
"0","                  pairOId = paste0(donor_oid, ""_"", recipient_oid),"
"0","                  pairOId_HW = gsub(""KE"", ""HW"", pairOId)) %>% "
"0","                      filter(days_between_samples >= 0)"
"0","message(nrow(df_all_ch3_pairs), "" donor recipient pairs produced for evaluation"")"
"2","2824 donor recipient pairs produced for evaluation
"
"0","saveRDS(df_all_ch3_pairs, ""CH3_transmission_pairs.RDS"")"
"0","### Add days difference to df_staug_minor_allele_distn"
"0","#df_staug_minor_allele_distn_ <- inner_join(df_staug_minor_allele_distn, df_days_between_confirm_ch1[, c(""days_"",""pairId"")], by = c(""from_to"" = ""pairId""))"
